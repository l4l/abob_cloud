# AbobCloud

Сервис представляет собой облачное хранилище фотографий, которые содержат в себе флаг, зашитый с помощью стеганографии. При этом флаг получается на основе публично-известного ключа. Особенность его в том, что сервис предоставляет "истекшую лицензию" и просит ввести ключ, что затрудняет изначальный его запуск


## Флаг

Стега из картинки с примененным к ней шифрованием, e.g: `Enc_k(f(Img))`

При этом `f` является "чистой функции", следовательно `f(Img)` является общим для всех


## Протокол

Общение с сервисом происходит с помощью UDP и TCP пакетов.

Команды:

- Отправить png изображение (TCP)
- Получить публичный ключ (UDP)
- Получить флаг по хэшу (UDP)


## Основной флоу для сервиса

### Push

.
   jury -> service   Send image __Img__
service -> service   Save __Img__ it to DB: `INSERT INTO imgs VALUES(Hash PRIMARY, Img)`

### Pull

.
   jury -> service   Request __Img__ by its hash `H(Img)`
service -> service   Find __Img__ in DB, calculate flag from it: `Stg=f(Img)`
service -> jury      Send `E=Enc_privkey(Stg)`
   jury -> service   Request pubkey 
   jury -> jury      Check flag `Dec_pubkey(E)=Stg == Stg_orig`


## Фичи

Сервис требует ключ для своей работы. Требуется разреверсить алгоритм получения ключа и либо сгенерировать его для запуска, либо запатчить лаунчер.

Директория с сервисом хранит:

    - rwx: сервис elf64 + canary + no aslr
    - rw-: конфиг (ip+port журейки, ключ для вычисления флага)
    - rw-: лицензионный ключ
    - rw-: sqlite базу данных с картинками


## Фичи

Сервис требует ключ для своей работы. Требуется разреверсить алгоритм получения ключа и либо сгенерировать его для запуска, либо запатчить лаунчер.

Директория с сервисом хранит:

    - rwx: сервис elf64 + canary + no aslr
    - rw-: конфиг (ip+port журейки, ключ для вычисления флага)
    - rw-: лицензионный ключ
    - rw-: sqlite базу данных с картинками


## Уязвимости

- RCE: специальное изображения
- Default config: по дефолту ключ для получения флага у всех один и тот же
- RC bug -> read overflow -> picture leak
